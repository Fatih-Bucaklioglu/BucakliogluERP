<Page x:Class="BucakliogluERP.Views.SiparisPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Yeni Sipariş"
      Background="Transparent">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="20">
            <!-- Başlık ve Butonlar -->
            <Grid Margin="0,0,0,20">
                <TextBlock Text="" 
                          FontSize="28" 
                          FontWeight="Bold"
                          Foreground="#2C3E50"
                          VerticalAlignment="Center"/>

                <StackPanel Orientation="Horizontal" 
                           HorizontalAlignment="Right">
                    <Button Content="💾 Kaydet" 
                           Click="Kaydet_Click"
                           Background="#27AE60"
                           Foreground="White"
                           Padding="15,8"
                           Margin="0,0,10,0"
                           BorderThickness="0"
                           FontWeight="SemiBold"/>

                    <Button Content="📄 PDF Export" 
                           Click="ExportPDF_Click"
                           Background="#3498DB"
                           Foreground="White"
                           Padding="15,8"
                           Margin="0,0,10,0"
                           BorderThickness="0"
                           FontWeight="SemiBold"/>

                    <Button Content="🖨️ Yazdır" 
                           Click="Yazdir_Click"
                           Background="#14A085"
                           Foreground="White"
                           Padding="15,8"
                           BorderThickness="0"
                           FontWeight="SemiBold"/>
                    <!-- Başlık ve Butonlar bölümünde PDF butonundan sonra ekleyin -->
                    <Button Content="📊 Excel Export" 
       Click="ExportExcel_Click"
       Background="#28A745"
       Foreground="White"
       Padding="15,8"
       Margin="0,0,10,0"
       BorderThickness="0"
       FontWeight="SemiBold"/>
                    <Button Content="👁️ Önizleme" 
       Click="Onizleme_Click"
       Background="#6C757D"
       Foreground="White"
       Padding="15,8"
       Margin="0,0,10,0"
       BorderThickness="0"
       FontWeight="SemiBold"/>
                </StackPanel>
            </Grid>

            <!-- Müşteri Bilgileri -->
            <Border Background="White" 
                   CornerRadius="10" 
                   Padding="20" 
                   Margin="0,0,0,20">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" 
                                    ShadowDepth="2" 
                                    Opacity="0.1"/>
                </Border.Effect>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Sol Kolon: Müşteri -->
                    <StackPanel Grid.Column="0" Margin="0,0,20,0">
                        <TextBlock Text="Müşteri Bilgileri" 
                                  FontSize="16" 
                                  FontWeight="Bold"
                                  Margin="0,0,0,15"/>

                        <TextBlock Text="Müşteri Adı" Margin="0,0,0,5"/>
                        <TextBox x:Name="txtMusteriAdi" 
                                Padding="10" 
                                FontSize="14"
                                Margin="0,0,0,10"/>

                        <TextBlock Text="Telefon" Margin="0,0,0,5"/>
                        <TextBox x:Name="txtTelefon" 
                                Padding="10" 
                                FontSize="14"
                                Margin="0,0,0,10"/>

                        <TextBlock Text="Firma" Margin="0,0,0,5"/>
                        <TextBox x:Name="txtFirma" 
                                Padding="10" 
                                FontSize="14"/>
                    </StackPanel>

                    <!-- Sağ Kolon: Sipariş -->
                    <StackPanel Grid.Column="1">
                        <TextBlock Text="Sipariş Bilgileri" 
                                  FontSize="16" 
                                  FontWeight="Bold"
                                  Margin="0,0,0,15"/>

                        <TextBlock Text="Sipariş No" Margin="0,0,0,5"/>
                        <TextBox x:Name="txtSiparisNo" 
                                Padding="10" 
                                FontSize="14"
                                Margin="0,0,0,10"/>

                        <TextBlock Text="Tarih" Margin="0,0,0,5"/>
                        <DatePicker x:Name="dpTarih" 
                                   Padding="10" 
                                   FontSize="14"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Kategori Seçimi -->
            <Border Background="White" 
                   CornerRadius="10" 
                   Padding="20" 
                   Margin="0,0,0,20">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" 
                                    ShadowDepth="2" 
                                    Opacity="0.1"/>
                </Border.Effect>

                <StackPanel>
                    <TextBlock Text="Kategori Seçin" 
                              FontSize="16" 
                              FontWeight="Bold"
                              Margin="0,0,0,15"/>

                    <StackPanel Orientation="Horizontal">
                        <Button Content="Profil" 
                               Tag="profil"
                               Click="Kategori_Click"
                               Padding="20,10" 
                               Margin="0,0,10,0"
                               Background="#ECF0F1"
                               BorderThickness="0"/>

                        <Button Content="Boru" 
                               Tag="boru"
                               Click="Kategori_Click"
                               Padding="20,10" 
                               Margin="0,0,10,0"
                               Background="#ECF0F1"
                               BorderThickness="0"/>

                        <Button Content="Saç" 
                               Tag="sac"
                               Click="Kategori_Click"
                               Padding="20,10" 
                               Margin="0,0,10,0"
                               Background="#ECF0F1"
                               BorderThickness="0"/>

                        <Button Content="Hırdavat" 
                               Tag="hirdavat"
                               Click="Kategori_Click"
                               Padding="20,10" 
                               Margin="0,0,10,0"
                               Background="#ECF0F1"
                               BorderThickness="0"/>

                        <Button Content="Lema" 
                               Tag="lema"
                               Click="Kategori_Click"
                               Padding="20,10"
                               Background="#ECF0F1"
                               BorderThickness="0"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Ürün Ekleme -->
            <Border x:Name="borderUrunEkleme" 
                   Background="White" 
                   CornerRadius="10" 
                   Padding="20" 
                   Margin="0,0,0,20"
                   Visibility="Collapsed">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" 
                                    ShadowDepth="2" 
                                    Opacity="0.1"/>
                </Border.Effect>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                        <TextBlock Text="Ürün Seçin" Margin="0,0,0,5"/>
                        <ComboBox x:Name="cmbUrunler" 
                                 Padding="10" 
                                 FontSize="14"
                                 SelectionChanged="CmbUrunler_SelectionChanged"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" 
                               x:Name="panelIskonto"
                               Margin="0,0,10,0"
                               Visibility="Collapsed">
                        <TextBlock Text="İskonto Oranı" Margin="0,0,0,5"/>
                        <ComboBox x:Name="cmbIskonto" 
                                 Padding="10" 
                                 FontSize="14"
                                 SelectionChanged="CmbIskonto_SelectionChanged">
                            <ComboBoxItem Content="28%" Tag="28%"/>
                            <ComboBoxItem Content="29%" Tag="29%"/>
                            <ComboBoxItem Content="30%" Tag="30%"/>
                            <ComboBoxItem Content="31%" Tag="31%"/>
                            <ComboBoxItem Content="32%" Tag="32%"/>
                            <ComboBoxItem Content="33%" Tag="33%"/>
                            <ComboBoxItem Content="34%" Tag="34%"/>
                            <ComboBoxItem Content="35%" Tag="35%" IsSelected="True"/>
                            <ComboBoxItem Content="36%" Tag="36%"/>
                            <ComboBoxItem Content="37%" Tag="37%"/>
                            <ComboBoxItem Content="38%" Tag="38%"/>
                            <ComboBoxItem Content="39%" Tag="39%"/>
                        </ComboBox>
                    </StackPanel>

                    <Button Grid.Column="2" 
                           Content="➕ Ekle" 
                           Click="UrunEkle_Click"
                           Background="#27AE60"
                           Foreground="White"
                           Padding="20,10"
                           VerticalAlignment="Bottom"
                           BorderThickness="0"
                           FontWeight="SemiBold"/>
                </Grid>
            </Border>

            <!-- Sipariş Tablosu -->
            <Border x:Name="borderSiparisTablosu"
                   Background="White" 
                   CornerRadius="10" 
                   Padding="20"
                   Visibility="Collapsed">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="10" 
                                    ShadowDepth="2" 
                                    Opacity="0.1"/>
                </Border.Effect>

                <StackPanel>
                    <TextBlock Text="Sipariş Detayları" 
                              FontSize="16" 
                              FontWeight="Bold"
                              Margin="0,0,0,15"/>

                    <DataGrid x:Name="dgSiparisler" 
                             AutoGenerateColumns="False"
                             CanUserAddRows="False"
                             HeadersVisibility="Column"
                             GridLinesVisibility="Horizontal"
                             RowHeight="40"
                             FontSize="13"
                             CellEditEnding="DgSiparisler_CellEditEnding">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="No" 
                                              Binding="{Binding No}" 
                                              Width="50" 
                                              IsReadOnly="True"/>
                            <DataGridTextColumn Header="Kategori" 
                                              Binding="{Binding Kategori}" 
                                              Width="*" 
                                              IsReadOnly="True"/>
                            <DataGridTextColumn Header="Ürün" 
                                              Binding="{Binding Ebat}" 
                                              Width="2*" 
                                              IsReadOnly="True"/>
                            <DataGridTextColumn Header="Miktar" 
                                              Binding="{Binding Miktar}" 
                                              Width="*"/>
                            <DataGridTextColumn Header="Birim Fiyat" 
                                              Binding="{Binding BirimFiyat, StringFormat={}{0:N2} ₺}" 
                                              Width="*" 
                                              IsReadOnly="True"/>
                            <DataGridTextColumn Header="Toplam" 
                                              Binding="{Binding Tutar, StringFormat={}{0:N2} ₺}" 
                                              Width="*" 
                                              IsReadOnly="True"/>
                            <DataGridTemplateColumn Header="" Width="60">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="🗑️" 
                                               Click="SiparisKalemiSil_Click"
                                               Background="#E74C3C"
                                               Foreground="White"
                                               BorderThickness="0"
                                               Padding="5"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>

                    <!-- Toplam Bölümü -->
                    <Border Background="#ECF0F1" 
                           CornerRadius="5" 
                           Padding="20" 
                           Margin="0,20,0,0"
                           HorizontalAlignment="Right"
                           Width="350">
                        <StackPanel>
                            <Grid Margin="0,0,0,10">
                                <TextBlock Text="Ara Toplam:" 
                                          FontSize="14"/>
                                <TextBlock x:Name="txtAraToplam" 
                                          Text="0,00 ₺" 
                                          FontSize="14" 
                                          FontWeight="SemiBold"
                                          HorizontalAlignment="Right"/>
                            </Grid>

                            <Grid Margin="0,0,0,10">
                                <TextBlock Text="KDV (%20):" 
                                          FontSize="14"/>
                                <TextBlock x:Name="txtKDV" 
                                          Text="0,00 ₺" 
                                          FontSize="14" 
                                          FontWeight="SemiBold"
                                          HorizontalAlignment="Right"/>
                            </Grid>

                            <Separator Margin="0,5"/>

                            <Grid Margin="0,10,0,0">
                                <TextBlock Text="Genel Toplam:" 
                                          FontSize="18" 
                                          FontWeight="Bold"/>
                                <TextBlock x:Name="txtGenelToplam" 
                                          Text="0,00 ₺" 
                                          FontSize="18" 
                                          FontWeight="Bold"
                                          Foreground="#27AE60"
                                          HorizontalAlignment="Right"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</Page>