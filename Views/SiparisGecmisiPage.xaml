<Page x:Class="BucakliogluERP.Views.SiparisGecmisiPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Sipariş Geçmişi"
      Background="Transparent">

    <Grid Margin="20">
        <Border Background="White" 
                CornerRadius="10" 
                Padding="30">
            <Border.Effect>
                <DropShadowEffect BlurRadius="10" ShadowDepth="2" Opacity="0.1"/>
            </Border.Effect>

            <StackPanel>
                <Grid Margin="0,0,0,20">
                    <TextBlock Text="Sipariş Geçmişi" 
                              FontSize="28" 
                              FontWeight="Bold"
                              Foreground="#2C3E50"/>

                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                        <TextBox x:Name="txtArama" 
                                Padding="10" 
                                Width="250"
                                Margin="0,0,10,0"
                                TextChanged="TxtArama_TextChanged"/>
                        <Button Content="🔍 Ara" 
                               Background="#3498DB"
                               Foreground="White"
                               Padding="15,8"
                               BorderThickness="0"
                               FontWeight="SemiBold"/>
                        <!-- txtArama'dan sonra buton ekleyin -->
                        <Button Content="📊 Tümünü Excel'e Aktar" 
       Click="TumunuExport_Click"
       Background="#28A745"
       Foreground="White"
       Padding="15,8"
       Margin="0,0,10,0"
       BorderThickness="0"
       FontWeight="SemiBold"/>
                    </StackPanel>
                    
                </Grid>
                <!-- txtArama'dan sonra -->
                <Button Content="🖨️ Toplu Yazdır" 
       Click="TopluYazdir_Click"
       Background="#9C27B0"
       Foreground="White"
       Padding="15,8"
       Margin="0,0,10,0"
       BorderThickness="0"
       FontWeight="SemiBold"/>
                <ScrollViewer Height="600" VerticalScrollBarVisibility="Auto">
                    <ItemsControl x:Name="lstSiparisler">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="#F8F9FA" 
                                       CornerRadius="10" 
                                       Padding="20" 
                                       Margin="0,0,0,15"
                                       Cursor="Hand"
                                       MouseLeftButtonDown="SiparisDetay_Click">
                                    <Grid>
                                        <StackPanel>
                                            <TextBlock FontSize="18" 
                                                      FontWeight="Bold"
                                                      Foreground="#2C3E50">
                                                <Run Text="Sipariş No: "/>
                                                <Run Text="{Binding SiparisNo}"/>
                                            </TextBlock>

                                            <TextBlock FontSize="13" 
                                                      Foreground="#6C757D"
                                                      Margin="0,5,0,0">
                                                <Run Text="Tarih: "/>
                                                <Run Text="{Binding Tarih, StringFormat=dd.MM.yyyy}"/>
                                            </TextBlock>

                                            <TextBlock FontSize="14" 
                                                      Margin="0,5,0,0">
                                                <Run Text="Müşteri: "/>
                                                <Run Text="{Binding Musteri.Muhattap}" FontWeight="SemiBold"/>
                                            </TextBlock>

                                            <TextBlock FontSize="13" 
                                                      Foreground="#6C757D"
                                                      Margin="0,3,0,0">
                                                <Run Text="Ürün Sayısı: "/>
                                                <Run Text="{Binding UrunSayisi}"/>
                                            </TextBlock>
                                        </StackPanel>

                                        <StackPanel HorizontalAlignment="Right" 
                                                   VerticalAlignment="Center">
                                            <TextBlock Text="{Binding GenelToplam, StringFormat={}{0:N2} ₺}" 
                                                      FontSize="24" 
                                                      FontWeight="Bold"
                                                      Foreground="#27AE60"/>
                                            <TextBlock Text="(KDV Dahil)" 
                                                      FontSize="11" 
                                                      Foreground="#6C757D"
                                                      HorizontalAlignment="Right"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>

                <!-- Boş Durum -->
                <StackPanel x:Name="bosPanel" 
                           HorizontalAlignment="Center" 
                           VerticalAlignment="Center"
                           Visibility="Collapsed"
                           Margin="0,100,0,0">
                    <TextBlock Text="📊" 
                              FontSize="60" 
                              HorizontalAlignment="Center"
                              Opacity="0.3"/>
                    <TextBlock Text="Henüz sipariş bulunmuyor" 
                              FontSize="18" 
                              Foreground="#6C757D"
                              HorizontalAlignment="Center"
                              Margin="0,10,0,0"/>
                </StackPanel>
            </StackPanel>
        </Border>
    </Grid>
</Page>